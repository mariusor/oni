## Container images

We are building container images for ONI that can be found on [quay.io](https://quay.io/go-ap/oni) image repository.

The containers are built based on the run environment type: `prod`, `qa` or `dev`:
  * `dev` images are built for every push, and they contain all debugging information
    and logging context possible. There is an additional caveat because the **HTTP-Signature**
    headers generated by them are not compatible with the [wider fediverse](https://pkg.go.dev/github.com/go-ap/client/s2s#HeadersToSign) 
    in favour of supporting requests with the same signature being replayed.
  * `qa` images are also built for every push, but the binaries are stripped,
    and they contain less debugging and logging information.
  * `prod` images are similar to `qa` ones but are created only when a 
    tagged version of the project is released.

### Running a container

To run a container based on these images, you can use podman:

```sh
# /var/cache/oni must be a valid directory file as shown in the INSTALL document.
# You shouldn't run the 'latest' tag in a production environment, because it usually
# points to a 'dev' image and will not federate with other instances.
$ podman run --network=host --name=ONI -v /var/cache/oni:/storage quay.io/go-ap/oni:latest
```

### Running `onictl` commands in the containers

```sh
# running with the same configuration environment as above
$ podman exec ONI onictl reload
```

